point:
  display:
    - material: STONE
  requirement-args:
    - price
    - reason
  args:
    reason: ''
    server: ''
    doneClose: true
  action:
    left:
      - 'js:
        main();
        function main(){
            var servers = "$server".split(",");
            var result = false;
            handler.sendMessage("单价是: $price reason: " + reason);
            if (eco.take(handler.getName(),$price,"POINT",reason)){
                title.sendTitle(handler, "§a§l购买成功");
                result = true;
            } else {
                handler.spigot().sendMessage(Java.type("net.wdsj.servercore.message.ServerMessages$Component").TAKE_POINT_FAIL);
            }
            if (doneClose){
                guimanager.static.close(handler);
            }

            return result;
        }
      '
item:
  display:
    - material: STONE
  requirement-args:
    - reason
    - items
    - number
    - priceDisplay
  args:
    reason: ''
    server: ''
    number: 1
    doneClose: 'true'
    priceDisplay: '§6{price}'
  initScript:
    - '
   init();
   function init(){
       print(items);
       var itemHandler = eco.getEcoHandler("ITEM");
       if(itemHandler!=null){
         var data = eco.createEcoData(itemHandler, utils.createSectionByList(items,"items"));
         print(data);
       }

       if(data !=null ){
         for each (var el in render.getDisplay()){
           el.getLore().add(priceDisplay.replace("{price}",data.getPriceDisplay() ));
         }

         options.put("BUY_ITEM_MODEL_DATA", data);
      }
   }

    '
  action:
    left:
      - 'js:
        main();
        function main(){
            var data = options.get("BUY_ITEM_MODEL_DATA");

           var itemHandler = eco.getEcoHandler("ITEM");
           if(data == null){
             handler.sendMessage("系统错误！请联系腐竹~");
             return false;
           }
            var result = false;
            if (eco.take(handler.getName(),itemHandler,data,1,null,reason)){
                title.sendTitles(handler, "§a§l购买成功");
                result = true;
            } else {
                title.sendTitles(handler, "§c§l物资不足" , "§6你需要: "+data.getPriceDisplay());
            }
            if (doneClose){
                guimanager.static.close(handler);
            }

            return result;
        }
      '